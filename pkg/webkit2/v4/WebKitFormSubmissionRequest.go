// Code generated by girgen. DO NOT EDIT.

package webkit2

import (
	"runtime"
	"unsafe"

	"github.com/diamondburned/gotk4/pkg/core/gextras"
	coreglib "github.com/diamondburned/gotk4/pkg/core/glib"
)

// #include <stdlib.h>
// #include <glib-object.h>
// #include <webkit2/webkit2.h>
import "C"

// GType values.
var (
	GTypeFormSubmissionRequest = coreglib.Type(C.webkit_form_submission_request_get_type())
)

func init() {
	coreglib.RegisterGValueMarshalers([]coreglib.TypeMarshaler{
		coreglib.TypeMarshaler{T: GTypeFormSubmissionRequest, F: marshalFormSubmissionRequest},
	})
}

// FormSubmissionRequestOverrides contains methods that are overridable.
type FormSubmissionRequestOverrides struct {
}

func defaultFormSubmissionRequestOverrides(v *FormSubmissionRequest) FormSubmissionRequestOverrides {
	return FormSubmissionRequestOverrides{}
}

// FormSubmissionRequest represents a form submission request.
//
// When a form is about to be submitted in a KitWebView, the
// KitWebView::submit-form signal is emitted. Its request argument
// contains information about the text fields of the form, that are
// typically used to store login information, returned as lists by
// webkit_form_submission_request_list_text_fields(). You can submit the form
// with webkit_form_submission_request_submit().
type FormSubmissionRequest struct {
	_ [0]func() // equal guard
	*coreglib.Object
}

var (
	_ coreglib.Objector = (*FormSubmissionRequest)(nil)
)

func init() {
	coreglib.RegisterClassInfo[*FormSubmissionRequest, *FormSubmissionRequestClass, FormSubmissionRequestOverrides](
		GTypeFormSubmissionRequest,
		initFormSubmissionRequestClass,
		wrapFormSubmissionRequest,
		defaultFormSubmissionRequestOverrides,
	)
}

func initFormSubmissionRequestClass(gclass unsafe.Pointer, overrides FormSubmissionRequestOverrides, classInitFunc func(*FormSubmissionRequestClass)) {
	if classInitFunc != nil {
		class := (*FormSubmissionRequestClass)(gextras.NewStructNative(gclass))
		classInitFunc(class)
	}
}

func wrapFormSubmissionRequest(obj *coreglib.Object) *FormSubmissionRequest {
	return &FormSubmissionRequest{
		Object: obj,
	}
}

func marshalFormSubmissionRequest(p uintptr) (interface{}, error) {
	return wrapFormSubmissionRequest(coreglib.ValueFromNative(unsafe.Pointer(p)).Object()), nil
}

// TextFields: get the values of the text fields contained in the form
// associated to request.
//
// Get a Table with the values of the text fields contained in the form
// associated to request. Note that fields will be missing if the form contains
// multiple text input elements with the same name, so this function does not
// reliably return all text fields.
//
// Deprecated: Use webkit_form_submission_request_list_text_fields() instead.
//
// The function returns the following values:
//
//   - hashTable (optional) with the form text fields, or NULL if the form
//     doesn't contain text fields.
//
func (request *FormSubmissionRequest) TextFields() map[unsafe.Pointer]unsafe.Pointer {
	var _arg0 *C.WebKitFormSubmissionRequest // out
	var _cret *C.GHashTable                  // in

	_arg0 = (*C.WebKitFormSubmissionRequest)(unsafe.Pointer(coreglib.InternObject(request).Native()))

	_cret = C.webkit_form_submission_request_get_text_fields(_arg0)
	runtime.KeepAlive(request)

	var _hashTable map[unsafe.Pointer]unsafe.Pointer // out

	if _cret != nil {
		_hashTable = make(map[unsafe.Pointer]unsafe.Pointer, gextras.HashTableSize(unsafe.Pointer(_cret)))
		gextras.MoveHashTable(unsafe.Pointer(_cret), false, func(k, v unsafe.Pointer) {
			ksrc := *(**C.gpointer)(k)
			vsrc := *(**C.gpointer)(v)
			var kdst unsafe.Pointer // out
			var vdst unsafe.Pointer // out
			kdst = (unsafe.Pointer)(unsafe.Pointer(ksrc))
			vdst = (unsafe.Pointer)(unsafe.Pointer(vsrc))
			_hashTable[kdst] = vdst
		})
	}

	return _hashTable
}

// Submit: continue the form submission.
func (request *FormSubmissionRequest) Submit() {
	var _arg0 *C.WebKitFormSubmissionRequest // out

	_arg0 = (*C.WebKitFormSubmissionRequest)(unsafe.Pointer(coreglib.InternObject(request).Native()))

	C.webkit_form_submission_request_submit(_arg0)
	runtime.KeepAlive(request)
}

// FormSubmissionRequestClass: instance of this type is always passed by
// reference.
type FormSubmissionRequestClass struct {
	*formSubmissionRequestClass
}

// formSubmissionRequestClass is the struct that's finalized.
type formSubmissionRequestClass struct {
	native *C.WebKitFormSubmissionRequestClass
}
